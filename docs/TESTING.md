# Testing the EMA-AI API

This document provides examples of how to test the EMA-AI API using curl commands.

## Prerequisites

- The EMA-AI service should be running (either locally or in Docker)
- Default URL is `http://localhost:8000` if running locally

## Health Check

To verify that the API is running:

```bash
curl -X GET http://localhost:8000/health
```

Expected response:

```json
{ "status": "ok", "version": "0.1.0" }
```

## Generate Adventure

To generate a new adventure based on a user prompt:

```bash
curl -X POST \
  -H "Content-Type: application/json" \
  -d '{"prompt": "Je cherche une randonnée près de Bordeaux"}' \
  http://localhost:8000/api/generate
```

Expected response:

```json
{
  "title": "Randonnée dans les vignobles de Saint-Émilion",
  "description": "Une belle balade à travers les célèbres vignobles de Saint-Émilion, offrant des vues panoramiques sur la campagne bordelaise.",
  "location": "Saint-Émilion, Bordeaux",
  "tags": ["randonnée", "vignoble", "nature", "patrimoine"],
  "difficulty": "facile",
  "duration": 120,
  "distance": 8.5,
  "latitude": 44.8946,
  "longitude": -0.1556
}
```

Note: The actual response will vary as it's generated by the AI.

## Find Similar Adventures

To find adventures similar to a given adventure ID:

```bash
curl -X POST \
  -H "Content-Type: application/json" \
  -d '{"adventure_id": 1}' \
  http://localhost:8000/api/search_similar
```

Expected response:

```json
{
  "similar_adventures": [
    {
      "id": 3,
      "title": "Balade dans les vignes de Pomerol",
      "similarity_score": 0.9
    },
    {
      "id": 7,
      "title": "Découverte du patrimoine viticole de Fronsac",
      "similarity_score": 0.8
    }
  ]
}
```

## API Documentation

For interactive API documentation, visit:

- Swagger UI: http://localhost:8000/docs
- ReDoc: http://localhost:8000/redoc

## Testing with Python

You can also test the API using Python with the `requests` library:

```python
import requests
import json

# Base URL
base_url = "http://localhost:8000"

# Health check
response = requests.get(f"{base_url}/health")
print(f"Health check: {response.status_code}")
print(response.json())

# Generate adventure
adventure_data = {"prompt": "Je cherche une randonnée près de Bordeaux"}
response = requests.post(f"{base_url}/api/generate", json=adventure_data)
print(f"Generate adventure: {response.status_code}")
print(json.dumps(response.json(), indent=2, ensure_ascii=False))

# Find similar adventures
similar_data = {"adventure_id": 1}
response = requests.post(f"{base_url}/api/search_similar", json=similar_data)
print(f"Find similar adventures: {response.status_code}")
print(json.dumps(response.json(), indent=2, ensure_ascii=False))
```

## Integration Testing

For testing the integration with the Rails API, see the [INTEGRATION.md](INTEGRATION.md) document.
